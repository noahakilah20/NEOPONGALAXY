<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Snake Neon</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #000;
      overflow: hidden;
    }
    canvas {
      display: block;
      margin: auto;
      background: #111;
      box-shadow: 0 0 20px #0ff;
    }
  </style>
</head>
<body>
<canvas id="gameCanvas" width="400" height="400"></canvas>

<script>
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");

  const gridSize = 20;
  const tileCount = canvas.width / gridSize;

  let snake = [{ x: 10, y: 10 }];
  let dx = 1;
  let dy = 0;
  let food = gerarComida();
  let growing = false;

  let lastTouchX = null;
  let lastTouchY = null;

  function gerarComida() {
    return {
      x: Math.floor(Math.random() * tileCount),
      y: Math.floor(Math.random() * tileCount),
    };
  }

  function desenhar() {
    ctx.fillStyle = "#111";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // comida
    ctx.fillStyle = "#0ff";
    ctx.shadowBlur = 10;
    ctx.shadowColor = "#0ff";
    ctx.fillRect(food.x * gridSize, food.y * gridSize, gridSize, gridSize);
    ctx.shadowBlur = 0;

    // cobrinha
    ctx.fillStyle = "#0f0";
    snake.forEach((segmento, i) => {
      ctx.fillRect(segmento.x * gridSize, segmento.y * gridSize, gridSize, gridSize);
    });
  }

  function mover() {
    const cabeca = { x: snake[0].x + dx, y: snake[0].y + dy };

    // Game over: fora do canvas ou se bater nela mesma
    if (
      cabeca.x < 0 || cabeca.x >= tileCount ||
      cabeca.y < 0 || cabeca.y >= tileCount ||
      snake.some((s, i) => i > 0 && s.x === cabeca.x && s.y === cabeca.y)
    ) {
      alert("Game Over!");
      snake = [{ x: 10, y: 10 }];
      dx = 1; dy = 0;
      food = gerarComida();
      return;
    }

    snake.unshift(cabeca);

    if (cabeca.x === food.x && cabeca.y === food.y) {
      food = gerarComida();
    } else {
      snake.pop();
    }
  }

  function loop() {
    mover();
    desenhar();
  }

  setInterval(loop, 150);

  // Controle por teclado
  document.addEventListener("keydown", (e) => {
    if (e.key === "ArrowUp" && dy === 0) { dx = 0; dy = -1; }
    if (e.key === "ArrowDown" && dy === 0) { dx = 0; dy = 1; }
    if (e.key === "ArrowLeft" && dx === 0) { dx = -1; dy = 0; }
    if (e.key === "ArrowRight" && dx === 0) { dx = 1; dy = 0; }
  });

  // Controle por toque (slide)
  canvas.addEventListener("touchstart", (e) => {
    lastTouchX = e.touches[0].clientX;
    lastTouchY = e.touches[0].clientY;
  });

  canvas.addEventListener("touchmove", (e) => {
    if (!lastTouchX || !lastTouchY) return;

    const deltaX = e.touches[0].clientX - lastTouchX;
    const deltaY = e.touches[0].clientY - lastTouchY;

    if (Math.abs(deltaX) > Math.abs(deltaY)) {
      if (deltaX > 0 && dx === 0) { dx = 1; dy = 0; }
      else if (deltaX < 0 && dx === 0) { dx = -1; dy = 0; }
    } else {
      if (deltaY > 0 && dy === 0) { dx = 0; dy = 1; }
      else if (deltaY < 0 && dy === 0) { dx = 0; dy = -1; }
    }

    lastTouchX = null;
    lastTouchY = null;
    e.preventDefault();
  }, { passive: false });
</script>
</body>
</html>